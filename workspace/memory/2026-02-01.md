# 2026-02-01 Session Notes

## Config Tuning Session (12:20 AM - 1:00 AM)

Major OpenClaw config changes made tonight:

### Memory & Compaction
- `memorySearch.sources: ["memory", "sessions"]` â€” now searches session transcripts
- `memorySearch.experimental.sessionMemory: true` â€” experimental session indexing
- `compaction.memoryFlush.enabled: true` â€” flushes context before compaction (was already set)

### Thinking & Models
- `thinkingDefault: "high"` â€” extended thinking enabled globally (was "off")
- `subagents.model: "anthropic/claude-haiku-4-5"` â€” sub-agents use Haiku to save tokens

### Discord
- `channels.discord.replyToMode: "first"` â€” replies thread to trigger message
- `typingMode: "thinking"` â€” shows typing indicator while generating

### Tools & Media
- `tools.media.image.enabled: true` â€” can understand images
- `messages.inbound.debounceMs: 1500` â€” batches rapid messages (1.5s window)
- `contextPruning.mode: "cache-ttl"` â€” trims stale tool results

### Gmail Webhooks
- Set up `hooks.gmail` with billchirico@gmail.com
- Using Tailscale funnel at `/gmail-hook`
- Need to verify gog CLI is authenticated

### Elevated Commands
- Bill decided to keep `tools.elevated.enabled: false`
- The allowFrom list has his Discord ID ready if needed later

## Kanban Board
- Created project: **discord-bot** (id: `discord-bot-FvpVs_`)
- Board URL: http://bill.tail8b4599.ts.net:3000

## Important Correction
- Tailscale hostname is `bill.tail8b4599.ts.net` â€” NOT `bills-1`
- Updated TOOLS.md and MEMORY.md with correct hostname

## Discussed but Skipped
- mem0.ai â€” decided current memory setup is sufficient
- MCP servers â€” discussed options but no action taken

---

## Late Night Session (1:00 AM - 1:40 AM)

### Config Backup System (CRITICAL)
- Created `/home/bill/.openclaw/config-backups/` directory
- **New rule**: ALWAYS backup config before ANY `config.patch` or `config.apply`
- Command: `cp /home/bill/.openclaw/openclaw.json /home/bill/.openclaw/config-backups/openclaw.$(date +%Y%m%d-%H%M%S).json`
- Added to AGENTS.md and MEMORY.md as mandatory

### Gateway Crash & Fix
- Crashed gateway trying to configure Gmail hooks + Tailscale funnel
- Root cause: `gateway.tailscale.mode: "funnel"` conflicted with hooks config
- **Fix**: Set `gateway.tailscale.mode: "off"` â€” let `hooks.gmail.tailscale` handle funnel separately
- hookUrl must use Tailscale IP (`100.86.34.31:18789`), not localhost

### Gmail Push Notifications Working! ðŸŽ‰
- Pub/Sub topic: `projects/billsopenclaw/topics/gog-gmail-watch`
- Subscription: `gog-gmail-watch-sub`
- Push endpoint: `https://bill.tail8b4599.ts.net/gmail-pubsub`
- Funnel enabled and verified receiving test messages

### Claude Usage Monitoring
- Created script: `scripts/check-claude-usage.js`
- Hits `https://api.anthropic.com/api/oauth/usage` with OAuth token
- Reads creds from `~/.claude/.credentials.json`
- Returns 5-hour and 7-day utilization percentages
- Tracks threshold crossings in `memory/claude-usage-state.json`
- Alert thresholds: 50%+ moderate, 60%+ elevated, 70%+ warning, 80%+ high, **90%+ switch to GLM 4.7**
- Added to HEARTBEAT.md as first check

### Todoist Setup
- Found existing `td` CLI at `/home/bill/.npm-global/bin/td`
- API token: `e6e83394008cb35595ab94ab6ee7350c166ac50b`
- Command pattern: `TODOIST_API_TOKEN="..." td <command>`
- Updated TOOLS.md with quickref
- **Rule**: Always use `@openclaw` label when creating tasks

### Current Usage (1:27 AM)
- 5-hour: 48%
- 7-day: 43%
- Tier: claude_max_20x
